---
title: "QFISH"
output: html_document
date: "2025-09-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Load data and tidy it

Load tidyverse.
```{r, results = "hide"}
library(tidyverse)
```

Read data, make sure the header is set to true and replace all blank cells with zero.

```{r}
data <- read.csv("../data/QFISH_data_v2.csv", header = T)
data[data == ""] <- 0 

head(data)
```


Remove unnecessary columns and rows.
```{r}
data1 <- data[c(-1,-2,-28),c(-13,-26,-40,-54,-55)]

head(data1)
```

Pivot the data so the species group and location are columns. Then separate the species and location using the name pattern, and change the catch to numeric values.
```{r}
clean_data <- data1 %>% pivot_longer(cols = 2:50, names_to = c("SpeciesGroup","Location"), values_to = "Catch", names_pattern = "(.+)_(.+)", values_drop_na = T) 

clean_data$Catch <- as.numeric(as.character(clean_data$Catch))

head(clean_data)
```

# Plot data

We want to make a faceted line plot. Facets are the locations, x-axis is time, y-axis is catch, and groups within each facet are the species.
```{r}
 variable_labs <- c("Bribie.Island" = "Bribie Island", 
                    "Capricorn.Coast" = "Capricorn Coast",
                    "Cairns" = "Cairns",
                    "Gold.Coast" = "Gold Coast",
                    "Mackay" = "Mackay",
                    "Nth.Stradbroke.Is." = "North Stradbroke Island",
                    "Rainbow.Beach" = "Rainbow Beach",
                    "Sunshine.Coast.North" = "North Sunshine Coast", 
                    "Sunshine.Coast.South" = "South Sunshine Coast",
                    "Sunshine.Coast.South...Bribie.Island" = "South Sunshine Coast & Bribie Island",
"Townsville" = "Townsville",
"Bundaberg" = "Bundaberg",
"Gladstone" = "Gladstone")

clean_data %>% ggplot() +
  theme_bw() +
  facet_wrap(. ~ Location, labeller = as_labeller(variable_labs)) +
  geom_line(mapping = aes(x = Year,y = Catch, group = SpeciesGroup, color = SpeciesGroup)) +
  scale_y_continuous(limits = c(0, 600)) + 
  scale_x_discrete(breaks = c(2001,2005,2010,2015,2020,2025)) +
   theme(axis.text.x = element_text(angle = 45, hjust = 1),
          strip.text = element_text(size = 5))
```

